<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Test</title>
	<script type="text/javascript" src="scripts/require.js"></script>
	<link type="text/css" rel="stylesheet" href="style/common.css" >
</head>
<body>
	<canvas id="main" width="800" height="800"></canvas>
	<div>
		<div class="button button-toggle" id="btn-start">Start</div>
		<div class="button" id="btn-reset">Reset</div>
	</div>
	<script type="text/javascript">
	
		require.config({
			baseUrl: 'scripts/app',
			paths: {
				jquery: '../jquery-3.2.1.min'
			}
		});
		
		require(['jquery', 'main2d'], ($, M) => {
		
			$(() => {

				let _random_int = (min, max) => {
					return Math.floor(Math.random() * (max - min) + min);
				};

				let _random_color = () => {
					let _r = _random_int(0, 256);
					let _g = _random_int(0, 256);
					let _b = _random_int(0, 256);
					return `rgb(${_r}, ${_g}, ${_b})`;
				};

				let _create_random_objects = (count) => {
					let array = [];
					for ( let i = 0; i < count; i++ ) {
						let _mass = _random_int(10, 90);
						let obj = {
							mass: _mass,
							radius: Math.floor(Math.sqrt(_mass) * 5),
							color: _random_color(),
							v: [_random_int(-20, 20), _random_int(-20, 20)],
							p: [100 + Math.floor(i % 4) * 200, 100 + Math.floor(i / 4) * 200]
						};
						array.push(obj);
					}
					return array;
				};

				$('.button-toggle').click(() => {
					let _btn = $(event.target);
					_btn.toggleClass('pressed');
				});

				$('#btn-start').click(() => {
					let _btn = $(event.target);
					if ( _btn.hasClass('pressed') ) {
						M.start();
						_btn.text('Stop');
					} else {
						M.stop();
						_btn.text('Start');
					}
				});
				
				$('#btn-reset').click(() => {
					M.stop();
					M.reset();
					$('#btn-start').removeClass('pressed').text('Start');
				});

				let _objs = [{
				    mass: 1.9891e+33,
					radius: 6.96265e+8,
					p: [0, 0],
					v: [0, 0]
				}, {
                    mass: 5.9742e+24,
                    radius: 12756.1 / 2,
                    p: [1.4966918e+11, 0],
                    v: [0, 0]
				}];

				let _scale = 300 / 1.4966918e+11;
				
				M.init({
					canvas: $('#main')[0],
					objs: _objs,
					interval: 0.1,
					gravity: true,
					G: 5e+2,
					transform: [
                        _scale, 0,
						0, -_scale,
						0, 0
					]
				});
			});
		});
	</script>
</body>
</html>